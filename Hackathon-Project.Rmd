---
title: "Hackathon Project"
output: html_document
date: "2025-02-22"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
imdb_movies <- read_csv("~/Desktop/Hackathon-Project2025/imdb_top_1000.csv")

```

# Introduction

The main goal of a movie poster is to hook an audience into the idea of the movie. It goes without saying then that different genres may have different strategies in grabbing the attention of their corresponding audience. One of the first thing that comes to your attention when you see a poster is the color. Family movies, for example, may frequently use lighter colors or higher RGB values, while horror films may use darker colors as to illicit an eerie feeling from just the poster.

In this project, we are using the posters of the top 1000 rated movies on IMDB, mapping those movies to the respective percentages of each color in that poster. With this information, we can make conclusions about the types of colors that different genres of movies use to attract their audience and perhaps even make some assumptions about why movies chose these colors.

# Background

We collected this data from <a href = "https://www.kaggle.com/datasets/harshitshankhdhar/imdb-dataset-of-top-1000-movies-and-tv-shows?resource=download">Kaggle.com</a> and it was initially compiled straight from the IMDB database 4 years ago.

From this dataset, we will be using the following variable:

<ul>

<li>**Genre**: A list of Genres that corresponds to each movie. We will mutate this to only include the first genre, being the strongest corresponding genre</li>

<li>**Poster_Link**: Link to a jpeg file of the poster of the corresponding movie. We used this to create a program returning the percentages of each color used in the poster</li>

</ul>

# Mapping Color from JPEG

# Visualization

```{r}

generate_percentages <- function() {
  values <- runif(3)
  percentages <- values / sum(values) * 100
  return(percentages)
}

imdb_movies[c("Red", "Green", "Blue")] <- t(replicate(nrow(imdb_movies), generate_percentages()))


imdb_movies <- imdb_movies %>%
  mutate(Genres = as.character(Genre)) %>%
  separate(Genres, into = c("First_Genre", "Rest"), sep = ",", extra = "drop", fill = "right")

imdb_movies <- imdb_movies %>% select("Series_Title", "Red", "Green", "Blue", "First_Genre")

fake_movies <- imdb_movies %>% group_by(First_Genre) %>% summarize(Red = mean(Red), Green = mean(Green), Blue = mean(Blue))

fake_movies_long <- pivot_longer(fake_movies, 
                          cols = c(Red, Green, Blue), 
                          names_to = "Color", 
                          values_to = "Percentage")

fake_movies_long
```


```{r}
fake_movies <- imdb_movies %>% group_by(First_Genre) %>% summarize(Red = mean(Red), Green = mean(Green), Blue = mean(Blue))

long_data <- pivot_longer(fake_movies, 
                          cols = c(Red, Green, Blue), 
                          names_to = "Color", 
                          values_to = "Percentage")

fake_movies_long

# Perform ANOVA for Red, Green, Blue and extract p-values
anova_red <- aov(Percentage ~ First_Genre, data = long_data[long_data$Color == "Red", ])
anova_green <- aov(Percentage ~ First_Genre, data = long_data[long_data$Color == "Green", ])
anova_blue <- aov(Percentage ~ First_Genre, data = long_data[long_data$Color == "Blue", ])

summary(anova_green)
# Print p-values
p_value_red
p_value_green
p_value_blue

```

```{r}
# Running ANOVA for each color
anova_results <- lapply(1:3, function(i) {
  color_column <- c("Red", "Green", "Blue")  # Construct column name dynamically
  formula <- as.formula(paste(color_column, "~ genre"))
  aov(formula, data = imdb_movies)
})

# View the summary of the ANOVA results for each color
anova_summaries <- lapply(anova_results, summary)
anova_summaries

```


# Hypothesis Testing

### Question: Is there a correlation between the percent of red in a poster and the genre that the movie is in?

$$
H_0: \mu_{\text{Drama}} = \mu_{\text{Comedy}} \text{ ... } = \mu_{k} \\
H_{\alpha} = \text{at least 1 } \mu_{i} \neq \mu_{j} \text{ for all i, j}
$$

### Set the Significance Level

#### $0.05$

### ANOVA Testing

**Total Sum of Squares: SST**

Total variation in the dataset

$$
SST = \sum_{i=1}^{n} (Y_i - \overline{Y})^2 \\
Y_i = \text{each individual obervation in the sample} \\
\overline{Y} = \text{the mean ofobservations in the entire dataset}
$$

**Sum of Squares Between Groups: SSB**

Variation between genre mean and total dataset mean $$
SSB = \sum_{j=1}^{k} n_j (\overline{Y_j} - \overline{Y})^2 \\
n_j = \text{number of observations in genre } j \\
\overline{Y_j} = \text{mean observations in a genre } j \\
\overline{Y} = \text{mean of obervations in the entire dataset}
$$

**Sum of Squares Within Groups: SSW**

Variation within each group $$
SSW = \sum_{j=1}^{k} \sum_{i=1}^{n_j} (Y_{ij} - \overline{Y_j})^2 \\
Y_{ij} = \text{each obervation within a group } j \\
\overline{Y_j} = \text{mean of obervations within a group}
$$

**Mean Square Between Each Group: MSB**

Mean of squares divided by degrees of freedom for f-distribution $$
MSB = \frac{SSB}{k -1} \\
k = \text{number of genres}
$$

**Mean Square Within Each Group: MSW** $$
MSW = \frac{SSW}{n - k} \\
n - k = \text{number of movies - number of genres}
$$

**F-Statistic** 
$$
\frac{MSB}{MSW}
$$

**P-Value**:

Calculate the likelihood of obtaining a result equal to or less likely than the F-Stat calculated under the F-Distribution

### Results

```{r}

color_avg <- imdb_movies %>%
  group_by(First_Genre) %>%
  summarize(avg_red = mean(Red), 
            avg_green = mean(Green), 
            avg_blue = mean(Blue)) %>%
  pivot_longer(cols = c(avg_red, avg_green, avg_blue), 
               names_to = "Color", 
               values_to = "Average_Value")

color_mapping <- c("avg_red" = "red", "avg_green" = "green", "avg_blue" = "blue")

ggplot(color_avg, aes(x = First_Genre, y = Average_Value, fill = Color)) +
  geom_col(position = "dodge") +  scale_fill_manual(values = color_mapping) + 
  labs(title = "Average RGB Values by Genre", x = "Genre", y = "Average Color Value") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

```{r}
color_val <- imdb_movies %>%
  pivot_longer(cols = c(Red, Green, Blue), 
               names_to = "Color", 
               values_to = "Value")

color_mapping <- c("Red" = "red", "Green" = "green", "Blue" = "blue")


color_val %>%
  filter(Series_Title == "The Dark Knight") %>% 
  ggplot(aes(x = Color, y = Value, fill = Color)) + 
  geom_bar(stat = "identity", width = 1) +
  coord_polar(theta = "y") +
  geom_text(aes(label = paste0(round(Value, 1), "%")), 
            position = position_stack(vjust = 0.5)) + 
  scale_fill_manual(values = color_mapping) + coord_polar(theta = "y") +
  labs(title = "Color Distribution for The Dark Knight", 
       x = "Color", y = "Value") +
  theme_minimal()

color_val %>%
  filter(Series_Title == "The Dark Knight") %>% plot_ly(df, labels = ~Category, values = ~Value, type = 'pie', textinfo = 'percent', 
        text = ~paste0(Category, ": ", round(Value, 1), "%"), 
        marker = list(colors = RColorBrewer::brewer.pal(5, "Set3"))) %>%
  layout(
    title = "Movie Genre Distribution",  # Title for the pie chart
    showlegend = TRUE  # Display the legend
  )
```

```{r}
test_movie <- data.frame("Spider-Man": 4, "Red": 5)

test_movie
```

```{python}
import pandas as pd
import matplotlib.pyplot as plt

data = {'Movie Title': ['Spider-Man'],
        'Red': [45],
        'Green': [23],
        'Blue': [32]}

df = pd.DataFrame(data)

colors = ['red', 'green', 'blue']
df_row = df.iloc[0, 1:]

df_row

plt.figure(figsize=(6, 6))
plt.pie(df_row, labels=df_row.index, colors=colors, autopct='%1.1f%%', startangle=90)


plt.title(f"RGB Color Distribution for {df['Movie Title'][0]}")

plt.show()

```

$$
\Delta C = \sqrt{(rij - rk)^2+(gij-gk)^2 + (bij-bk)^2}
$$

## 
